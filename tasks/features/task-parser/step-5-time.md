# Step 5: æ—¶é—´è§£æå™¨

**é¢„è®¡æ—¶é—´**: 30 åˆ†é’Ÿ
**éš¾åº¦**: ä¸­ç­‰
**ä¾èµ–**: Step 4 (å®ä½“æå–)

---

## ğŸ¯ ç›®æ ‡

å®ç°è‡ªç„¶è¯­è¨€æ—¶é—´è¡¨è¾¾å¼åˆ° ISO 8601 çš„è½¬æ¢

---

## ğŸ“‹ å­æ­¥éª¤

### 5.1 å®‰è£…ä¾èµ– (2 min)

- [ ] `pip install python-dateutil`
- [ ] æ›´æ–° `requirements.txt`

**æ£€æŸ¥ç‚¹**: ä¾èµ–å®‰è£…å®Œæˆ

---

### 5.2 åˆ›å»ºæ—¶é—´è§£æå™¨ (12 min)

- [ ] åˆ›å»º `src/ai/parsers/time_parser.py`
- [ ] æ”¯æŒç›¸å¯¹æ—¶é—´: "æ˜å¤©"ã€"ä¸‹å‘¨ä¸‰"
- [ ] æ”¯æŒæ¨¡ç³Šæ—¶é—´: "ä¸‹åˆ"ã€"æ™šä¸Š"

**ä»£ç æ¡†æ¶**:
```python
from datetime import datetime, timedelta
from dateutil import parser as dateutil_parser

class TimeParser:
    # æ¨¡ç³Šæ—¶é—´æ˜ å°„
    FUZZY_TIME_MAP = {
        "æ—©ä¸Š": 9,
        "ä¸Šåˆ": 10,
        "ä¸­åˆ": 12,
        "ä¸‹åˆ": 14,
        "å‚æ™š": 17,
        "æ™šä¸Š": 19,
    }

    def parse(self, time_str: str, reference: datetime = None) -> datetime:
        reference = reference or datetime.now()
        # è§£æé€»è¾‘
        pass
```

**æ£€æŸ¥ç‚¹**: åŸºç¡€è§£æå™¨åˆ›å»º

---

### 5.3 å®ç°ç›¸å¯¹æ—¶é—´è§£æ (8 min)

- [ ] "æ˜å¤©" â†’ +1 day
- [ ] "ä¸‹å‘¨X" â†’ ä¸‹å‘¨å¯¹åº”æ˜ŸæœŸ
- [ ] "Xå¤©å" â†’ +X days

**æµ‹è¯•ç”¨ä¾‹**:
```python
assert parser.parse("æ˜å¤©ä¸‹åˆ3ç‚¹").hour == 15
assert parser.parse("ä¸‹å‘¨ä¸‰").weekday() == 2
```

**æ£€æŸ¥ç‚¹**: ç›¸å¯¹æ—¶é—´è§£æé€šè¿‡

---

### 5.4 å®ç°æŒç»­æ—¶é—´è§£æ (8 min)

- [ ] "1å°æ—¶" â†’ timedelta(hours=1)
- [ ] "åŠå¤©" â†’ timedelta(hours=4)
- [ ] "å…¨å¤©" â†’ is_all_day=True

**æ£€æŸ¥ç‚¹**: æŒç»­æ—¶é—´è§£æé€šè¿‡

---

## âœ… å®Œæˆæ ‡å‡†

- [ ] python-dateutil å®‰è£…
- [ ] TimeParser ç±»å®ç°
- [ ] ç›¸å¯¹æ—¶é—´æ”¯æŒ
- [ ] æŒç»­æ—¶é—´æ”¯æŒ
- [ ] æµ‹è¯•ç”¨ä¾‹é€šè¿‡

---

## ğŸ”— é“¾æ¥

- **ä¸Šä¸€æ­¥**: [Step 4 - å®ä½“æå–](./step-4-entity.md)
- **ä¸‹ä¸€æ­¥**: [Step 6 - å•å…ƒæµ‹è¯•](./step-6-test.md)
